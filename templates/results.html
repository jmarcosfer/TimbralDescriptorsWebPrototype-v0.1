{% extends "index.html" %}

{% block results %}
	<div id="wrapper">
		<div id="container">
			<div id="content_full">
				<div id="sidebar" style="float:right">
					<div class="content_box">
						<div>
							<h3>Audio Commons Timbral Descriptors</h3>
							{% for descriptor in descriptor_stats.keys() %}
							<h4 style="font-size:60%;text-align:center;">{{descriptor}}</h4>
							<div id={{descriptor}} class="slider-block"></div>
							{% endfor %}
						</div>
						
					</div>
				</div>
				<div class="search_paginator">

				</div>
				<p>Here are some {{ query_string }} sounds! Enjoy!</p>
				{% for embed_link in results %}
					<div class="sample_player_small">
						<iframe frameborder="0" scrolling="no" src={{embed_link}} width="481" height="86"></iframe>
					</div>
				{% endfor %}
			</div>
		</div>
	</div>

	<script>
		sliders = Array.from(document.getElementsByClassName("slider-block"));

		sliders.forEach((slider, index) => {

			noUiSlider.create(slider, {
				start: [0, 100],
				connect: true,
				range: {
					'min': 0,
					'max': 100
				}
			});

			// add event handler function:

			slider.noUiSlider.on("change", function() {
				let searchURL = window.location.href + "&f=" + slider

				let http = new XMLHttpRequest();
				http.open("GET", searchURL, true);
				http.send(null);
			});
		});

	</script>

{% endblock %}